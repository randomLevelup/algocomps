# Algorithmic Music Composition // Composition 1

## *By Jupiter Westbard*

#### 1. About
My first composition for this class is called "Context-Free Grammars Ain't Free (in G)". The joke is that I used a contextual grammar to generate the melody

I spent about 15-20 hours on this project

#### 2. The Program
You can generate a composition (a 30-second long 2-track midi file) by running:
```bash
python comp1.py [output_path] [--showmidi]
```
Each composition will be different, though there are a finite amount of combinations of melodic rulesets and chord seeds.

The `output_path` argument specifies the path for the output midi file. If no path is given, the default is `./comp1.mid`.

The `--showmidi` flag will open the output midi file in the environment's default program (i.e. musescore).

#### 3. Description
My program employs two types of grammars to generate a melody and chord progression, respectively:
1. The melody is generated using [Worth and Stepney's](https://www-users.york.ac.uk/~ss44/bib/ss/nonstd/eurogp05.htm) Schenkarian rendering technique to "render" a melody from a context-dependent L-system, such as the ones described by [Hogeweg and Hesper](https://tufts.primo.exlibrisgroup.com/permalink/01TUN_INST/1fml38t/cdi_crossref_primary_10_1016_0031_3203_74_90019_3).
2. The chords are generated with an implementation of [Steedman's](https://www.jstor.org/stable/40285282) 12-bar blues algorithm, using a subset of the rules described in his paper.
3. Some extra processing is done to layer the tracks together, including extending the chord progression so it ends at the same time as the melody.

#### 4. Visualization/Walkthrough

| **Program Stage**                                                                                                                                                                                                                                                                                             | **Example**                               |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------- |
| **Axiom**<br>An initial melodic string serving as the 'seed' for generating melodic content                                                                                                                                                                                                                   | `F1F0`                                    |
| **L-system generation:**<br>Starting with the axiom, context-dependent rules are applied in parallel for multiple generations (22 in this example)                                                                                                                                                            |       |
| **L-system "melody tree"**<br>The generated string is rendered into musical notes using a "Shenkarian" approach (only the 'leaves' of the tree produce notes). The melody is laid into a weighted hexatonic blues scale.                                                                                      |  |
| **Chord 'seed'**<br>A sequence of digits each representing which chord transformation rule to apply                                                                                                                                                                                                           | `[11244]`                                 |
| **Chord rule applications**<br>Starting with Steedman's 12-bar axiom, chord transformation rules are applied in the order described by the seed. Each rule has a chance to be skipped or to apply multiple times for even more variety.                                                                       |       |
| **Combined sheet music:**<br>Finally, two music21 `stream`s are created for the melody and chords, then inserted into a main `score` object, then written to a midi file and displayed to the user (if the `--showmidi` flag is present). The example here shows the first 4 bars of a generated composition. |       |

#### 5. Reflection
The compositions generated by this program are, to me, remeniscent of rambling solos over 12-bar blues progressions. They often have an experimental quality, though retain a fluid movement often with regognizable motifs that repeat and evolve. The freeness of the melody also contrasts quite-nicely with the rather standard-sounding blues chord progressions. Overall, while you could probably tell that comp1 was generated algorithmically, it often still feels like a familiar but fresh improvised line written by a human person.

#### 6. Difficulties
- I had a somewhat hard time implementing the context-dependent grammar, as the literature didn't exactly provide a clear implementation. I got it working pretty well, however.
- The chord transformation rules were more difficult to implement, and I had some difficulty with pattern-matching chords, especially when I had to match *sequences* of chords to satisfy a rule's left-hand-side.

---
